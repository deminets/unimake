# unimake (Universal makefile)

Универсальный Makefile, предназначен для сборки простейших проектов, состоящих из множества С/С++ файлов.
При этом возможно создание из одного набора исходных кодов нескольких бинарных результатов сборки с различными опциями компиляции.

Минимальные требования: разместить исходные `Makefile` и `unimakefile.mki` в директории с исходными кодами и выполнить команду make. В качестве имени собранного приложения, будет использовано имя текущей директории.

# Опции

bins-t - список целей, имена бинарных файлов.  
имя_цели-srcs - список файлов *.c и *.cpp  
имя_цели-ccflags_add -  флаги компилятора для указанной цели   
имя_цели-ldflags_add -  флаги линковщика для указанной цели  
имя_файла_с_расширением-ccflags_add - дополнительные флаги компилятора для казанного файла
имя_файла_с_расширением-ccflags_exc - если будут указаны флаги компилятора, будут применяться только эти флаги.    

# Расширения

Часть опций можно хранить в исходном коде, например: -O2:-Wall:-std=c99    
для этого в исходном Си коде следует добавить следующие строки:    
```
#ifdef MAKE_GET_FLAGS
#error CCFLAGS:-O2:-Wall:-std=c99
#error LDFLAGS:-lm
#endif
```
Указанные флаги, в процессе сборки, будут добавлены к флагам заданным в Makefile.   

# Примеры

1.  
Требуется собрать два приложения с различными опциями компиляции, используя один общий файл.
В данном случае Makefile будет выглядеть следующим образом

bins-t += app1 app2  

app1-srcs += file1.c file_share.c   
app1-ccflags_add := -O2  
app1-ldflags_add := -lm  
file_share.c-ccflags_exc := -s -O3 r -Wall -std=c99  

app2-srcs += file2.c file_share.c  
app1-ccflags_add := -O1  
app1-ldflags_add := -lrt  
file2.c-ccflags_add := -Wall  

